# 信用卡卡号识别

# 简介

利用tensorFlow与OpenCV实现了信用卡卡号识别，并通过EMNIST数据集与信用卡数字模板对卡号进行识别。

读取该信用卡上卡号的基本思路：

(1) 先对模板处理, 获取每个数字的模板及其对应的数字标识 

(2) 再对信用卡处理, 通过一系列预处理操作, 取出信用卡数字区域 

(3) 然后再取出每一个数字去和模板中的10个数字进行匹配

(4) 取概率最大的数字

# 主要代码

`card.py`:

1.图片显示函数 

2.模板读取 

3.模板灰度化、二值化 

4.模板轮廓计算、绘画、排序 

5.模板取数字、尺寸resize 

6.信用卡读取 

7.信用卡尺寸resize 

8.信用卡灰度化、卷积核、形态学顶帽 

9.信用卡sobel算子 

10.信用卡闭操作、全局二值化 

11.信用卡轮廓计算、绘画、遍历 

12.数字区域抠出、二值化 

13.轮廓计算、排序、尺寸resize 

14.模板匹配 

15.轮廓绘制 

16.数字显示

`train.py`:

这段代码是一个用于训练数字识别模型的脚本，采用卷积神经网络（CNN）实现。主要包含以下几个部分：

1. **导入所需的库**：使用`tensorflow`进行模型构建和训练，`os`用于路径操作，以及`emnist`库来获取训练和测试数据集。
2. **CNN类**：定义了一个简单的卷积神经网络结构，包括三层卷积层、两层最大池化层、一个全连接层和最后的分类层。网络旨在接收28x28像素的图像作为输入，并输出10个类别的概率，分别对应0到9的数字。
3. **DataSource类**：负责加载和预处理EMNIST数据集中的数字图像。这包括将图像的像素值归一化到0到1之间，以便模型训练。
4. **Train类**：
   - 在初始化时，创建CNN和DataSource实例。
   - 定义`train`方法，用于编译模型（使用Adam优化器和稀疏分类交叉熵损失函数），并在训练数据上训练模型。它还使用`ModelCheckpoint`回调来保存训练过程中的模型权重，方便未来加载和继续训练。
   - 模型训练完成后，在测试集上评估模型的准确性。
5. **主函数**：实例化`Train`类，并调用其`train`方法开始训练过程。

总之，这段代码通过建立一个简单的卷积神经网络模型，使用EMNIST数据集中的数字图像进行训练和测试，目的是识别和分类0到9的手写数字。